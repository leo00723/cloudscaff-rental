<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="close()" color="primary">
        <ion-icon
          slot="icon-only"
          name="arrow-back-outline"
          color="primary"
        ></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Add Inspection</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
  <ion-grid *ngIf="company$ | async as company">
    <ion-row class="py-2">
      <ion-col size="12">
        <h3>INSPECTION</h3>
      </ion-col>
      <ion-col>
        <ion-label>
          <h6>Code:</h6>
          <h6>Scaffold Code:</h6>
          <h6>Site Code:</h6>
          <h6>Date Issued:</h6>
        </ion-label>
      </ion-col>
      <ion-col>
        <ion-label>
          <h6>{{ inspection.code }}</h6>
          <h6>{{ inspection.scaffold.code }}</h6>
          <h6>{{ inspection.scaffold.siteCode }}</h6>
          <h6>{{ inspection.date | dateFormat | date }}</h6>
        </ion-label>
      </ion-col>
    </ion-row>

    <!-- <app-company-info-detail
      [customer]="customer"
      *ngIf="customer$ | async as customer"
    ></app-company-info-detail> -->

    <app-scaffold-editform
      [scaffold]="scaffold"
      (formResult)="updateScaffold($event)"
    ></app-scaffold-editform>
    <ion-row class="py-2">
      <ion-col class="p-0">
        <app-inspection-checklist
          [questions]="questions"
          (list)="updateList($event)"
          *ngIf="questions$ | async as questions"
        ></app-inspection-checklist>
        <table class="table table-bordered mb-3">
          <tbody>
            <tr class="align-middle">
              <td>Is the scaffold safe for use?</td>
              <td class="text-center">
                <ion-radio-group slot="end" [(ngModel)]="inspection.status">
                  <ion-item lines="none">
                    <ion-label>Yes</ion-label>
                    <ion-radio slot="end" value="Passed" mode="md"></ion-radio>
                  </ion-item>
                  <ion-item lines="none">
                    <ion-label>No</ion-label>
                    <ion-radio slot="end" value="Failed" mode="md"></ion-radio>
                  </ion-item>
                </ion-radio-group>
              </td>
            </tr>
          </tbody>
        </table>
        <app-input-text
          [textarea]="true"
          title="Notes"
          [optional]="true"
          (fieldChange)="inspection.notes = $event"
        ></app-input-text>
      </ion-col>

      <ion-col size="12">
        <app-multiuploader></app-multiuploader>
      </ion-col>
      <ion-col size="12">
        <ion-text><h4>Signature</h4></ion-text>
        <app-signature-pad
          #signature
          [showSave]="blob ? false : true"
          (res)="sign($event)"
        ></app-signature-pad>
      </ion-col>
    </ion-row>
    <ion-row class="mt-3">
      <ion-progress-bar type="indeterminate" *ngIf="loading"></ion-progress-bar>
      <ion-col size="12" class="text-end" *ngIf="!loading">
        <ion-button
          shape="round"
          color="success"
          *ngIf="customer$ | async as customer"
          [disabled]="inspection.status.length === 0 || !blob"
          (click)="create(customer)"
          >Create Inspection</ion-button
        >
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
